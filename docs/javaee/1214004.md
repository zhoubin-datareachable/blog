---
title: javaee-servlet
date: 2022-12-14
sidebar: auto
categories:
 - javaee
tags:
 - java
---

## 入门

**1.编写一个java类继承HttpServlet方法**

```java
public class myServlet extends HttpServlet{
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        resp.getWriter().write("this is my first servlet.");
    }
}
```

**2.配置web.xml**

```xml
<!-- 配置servlet路径 -->
<servlet>
    <servlet-name>my</servlet-name>
    <servlet-class>com.servlet.myServlet</servlet-class>
</servlet>
<!-- 配置访问方式 -->
<servlet-mapping>
    <servlet-name>my</servlet-name>
    <url-pattern>/my</url-pattern>
</servlet-mapping>
```

**运行结果**

```java
浏览器访问:
http://localhost:8000/test/my
浏览器显示:
this is my first servlet.
```

## 生命周期

Servlet的生命周期：

- 1、从第一次调用到服务器关闭。
- 2、如果Servlet在web.xml中配置了load-on-startup，生命周期为 从服务器启动到服务器关闭
- 3、注意：init方法是对Servlet进行初始化的一个方法，会在Servlet第一次 加载进行存储时执行
- 4、destory方法是在servlet被销毁时执行，也就服务器关闭时

```java
public class ServletLeft extends HttpServlet{
    //初始化方法，在servlet第一次加载内容时被调用
    @Override
    public void init() throws ServletException {
        System.out.println("servlet初始化完成");
    }
    //service方法，浏览器请求时被调用
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        System.out.println("service被调用");
    }
    //销毁方法，服务器关闭时调用
    @Override
    public void destroy() {
        System.out.println("servlet被销毁");
    }
}
```

**运行结果**

```text
运行结果

控制台:
servlet初始化完成-------浏览器第一次请求时被调用
service被调用-----------浏览器每次请求调用
service被调用-----------浏览器每次请求调用
service被调用-----------浏览器每次请求调用
servlet被销毁-----------服务器关闭调用
```

**如果想启动服务器就初始化servlet则需要下面的配置**

```xml
<!--加上次标签则在服务器启动就调用-->
<load-on-startup>1</load-on-startup>
```

**完整代码**

```xml
<!-- 配置servlet路径 -->
<servlet>
    <servlet-name>lift</servlet-name>
    <servlet-class>com.servlet.ServletLeft</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<!-- 配置访问方式 -->
<servlet-mapping>
    <servlet-name>lift</servlet-name>
    <url-pattern>/lift</url-pattern>
</servlet-mapping>
```

## request对象

作用：request对象中封存了当前请求的所有请求信息

### 获取请求头数据

```java
public class RequestServlet extends HttpServlet{
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //获取请求头数据
        //获取请求方式
        String method = req.getMethod();
        System.out.println("请求方式:"+method);
        //获取请求URL+URI
        StringBuffer url = req.getRequestURL();
        System.out.println("url地址:"+url);
        String uri = req.getRequestURI();
        System.out.println("uri地址:"+uri);
        //获取协议
        String h = req.getScheme();
        System.out.println("网络协议:"+h);
    }
}
```

**运行结果**

```text
浏览器:
http://localhost:8000/test/request
控制台:
请求方式:GET
url地址:http://localhost:8000/test/request
uri地址:/test/request
网络协议:http
```

### 获取用户数据

**定义表单**

```html
<body>
    <form action="request" method="post">
        用户名：<input type="text" name="username"><br />
        密码：<input type="password" name="password"><br />
        爱好：<br />
        <input type="checkbox" name="hobbys" value="sing"/>唱歌<br />
        <input type="checkbox" name="hobbys" value="dance"/>跳舞<br />
        <input type="checkbox" name="hobbys" value="swim"/>游泳<br />
        <input type="submit" value="登录">
    </form>
</body>
```

**定义servlet**

```java
public class RequestServlet extends HttpServlet{
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //获取用户数据
        String name=req.getParameter("username");
        String pwd=req.getParameter("password");
        System.out.println("用户名:"+name);
        System.out.println("密码:"+pwd);
        //获取所有的用户请求数据的键的枚举集合---req.getParameterNames()
        String[] hobbys=req.getParameterValues("hobbys");
        System.out.println("爱好:");
        if(hobbys!=null){
            for(String hobby:hobbys){
                System.out.print(hobby+" ");
            }
        }   
    }
}
```

**运行结果**

```text
浏览器:
http://localhost:8000/test/index.jsp
填入参数提交
控制台:
用户名:zhangsan
密码:123
爱好:
sing dance swim
```

## response对象

**作用：** 用来响应数据到浏览器的一个对象

### 设置响应头

- setHeader方法会覆盖同名对象
- addHeader方法捕获覆盖同名对象

```java
public class ResponseServlet extends HttpServlet{
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //设置响应头
        //setHeader会覆盖同名对象
        resp.setHeader("phone", "MI");
        resp.setHeader("phone", "HUAWEI");
        //addHeader不会覆盖同名对象
        resp.addHeader("laptop", "MAC");
        resp.addHeader("laptop", "ASUS");
    }
}
```

![img](data:image/png;base64,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)

### 设置响应状态码

```java
//设置响应状态码
resp.sendError(404,"this Method is not supported");
```

![img](./assets/0.33092076623014877.46636d03.png)

### 设置响应实体

```java
//设置响应实体
resp.getWriter().write("<h1>response响应实体</h1>");
```

![img](./assets/0.16988514235261434.755a4452.png)

**存在问题：中文乱码**

### 设置响应编码格式

```java
//设置响应编码格式
//方法一:
resp.setHeader("content-type", "text/html;charset=utf-8");
//方法二:推荐使用
resp.setContentType("text/html;charset=utf-8");
```

![img](data:image/png;base64,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)

**上面的问题可以得到解决**

```java
public class ResponseServlet extends HttpServlet{
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //设置响应编码格式
        //resp.setHeader("content-type", "text/html;charset=utf-8");
        resp.setContentType("text/html;charset=utf-8");
        //设置响应实体
        resp.getWriter().write("<h1>response响应实体</h1>");
    }
}
```

![img](./assets/0.7456881881058597.aed5fd34.png)

## 转发和重定向

### 请求转发

- **作用:** 实现多个servlet联动操作处理请求，这样避免代码冗余，让servlet的职责更加明确。
- **使用：** `req.getRequestDispatcher("要转发的地址").forward(req, resp);`
- **地址：** 相对路径，直接书写servlet的别名即可。
- **特点:** **一次请求**，**浏览器地址栏信息不改变**。
- **注意：** 请求转发后直接`return`结束即可。

```java
if(u!=null) {
    resp.getWriter().write("登录成功");
}else {
    //登录失败请求转发
    req.getRequestDispatcher("page").forward(req, resp);
    return;
}
```

### 重定向

- **重定向：** 解决了表单重复提交的问题，以及当前servlet无法处理的请求的问题。

- **使用:**`resp.sendRedirect(String uri);`

- **示例:**`resp.sendRedirect("/login/main");`

- **特点：** **1.两次请求，两个request对象。2.浏览器地址栏信息改变**

- **时机：**

  **1.如果请求中有表单数据，而数据又比较重要，不能重复提交，建议使用重定向。**

  **2.如果请求被Servlet接收后，无法进行处理，建议使用重定向定位到可以处理的源**

```java
if(u!=null) {
    //重定向
    resp.sendRedirect("/test/main");
}else {
    //登录失败请求转发
    req.getRequestDispatcher("page").forward(req, resp);
    return;
}
```

## request对象的作用域

- **使用：**`request.setAttribute(objectname,Objectvalue);` `request.getAttribute(Objectobj);`
- **作用：** 解决了一次请求内的不同 Servlet 的数据(请求数据+其他数据)共享问题。
- **作用域：** 基于请求转发，一次请求中的所有 Servlet 共享。
- **注意：** 使用 Request 对象进行数据流转，数据只在一次请求内有效。
- **特点：** 1.服务器创建 2.每次请求都会创建 3.生命周期一次请求

```java
if(u!=null) {
	resp.getWriter().write("登录成功");
}else {
    //存取request作用域对象
    req.setAttribute("str", "用户名或密码错误");
    req.getRequestDispatcher("page").forward(req, resp);
    return;
}
```

## Cookie对象

### 1.cookie的创建

```java
//创建cookie对象
Cookie c = new Cookie("phone", "MI");
//响应cookie信息
resp.addCookie(c);
```

![image-20210127165130221](./assets/image-20210127165130221.9f1ffa21.png)

**特点** ：cookie会存储在浏览器的**运行内存**中，请求同项目其他地址会附带。

**问题：关闭浏览器cookie会失效**

**解决：设置有效期**

### 2.cookie的有效期

```java
//创建cookie对象
Cookie c = new Cookie("phone", "MI");
//设置cookie有效期(单位秒)
c.setMaxAge(3600*24*3);
//响应cookie信息
resp.addCookie(c);
```

![image-20210127165312285](./assets/image-20210127165312285.4407fd6f.png)

**特点：cookie存储在硬盘**中，在设置时间(3天)内不会失效

**问题：** 同项目下每个请求都附带cookie

**解决：设置cookie有效路径**

### 3.cookie有效路径

```java
//创建cookie对象
Cookie c = new Cookie("phone", "MI");
//设置cookie有效期(单位秒)
c.setMaxAge(3600*24*3);
//设置有效路径
c2.setPath("/cookie/abc");
//响应cookie信息
resp.addCookie(c);
```

**作用：在访问/cookie/abc才会附带cookie信息，其他地址则不会附带**

### 4.cookie信息的获取

```java
//获取cookie信息
Cookie[] cks = req.getCookies();
if(cks!=null) {
    for(Cookie c:cks) {
        String name = c.getName();
        String value = c.getValue();
        System.out.println(name+":"+value);
    }
}
```

## session对象

**问题：** 一个用户的不同请求处理的数据共享怎么办？

**解决：** 使用session技术

**原理：** 用户第一次访问服务器，服务器会创建一个session对象给此用户，并将该session对象的JSESSIONID使用Cookie技术存储到浏览器中，保证用户的其他请求能够获取到同一个session对象，也保证了不同请求能够获取到共享的数据。

**特点：** 1.存储在服务器端 2.服务器进行创建 3.依赖Cookie技术 4.一次会话 5.默认存储时间是30分钟

**作用：** 解决了一个用户不同请求处理的数据共享问题

**简单理解：** 用户第一次访问服务器，服务器将在服务器上创建一个柜子(session对象)，并将打开柜子的钥匙(JSESSIONID)发送到浏览器存储(使用cookie技术),用户访问其他页面时就会附带这个钥匙(JSESSIONID)

**总结：**

session解决了一个用户的不同请求的数据共享问题，只要在JSESSIONID不失效和session对象不失效的情况下。

用户的任意请求在处理时都能获取到同一个session对象。

**作用域：** 1.一次会话 2.在JSESSIONID和SESSION对象不失效的情况下为整个项目内。

**session失效处理：** 将用户请求中的JSESSIONID和后台获取到的SESSION对象的JSESSIONID进行比对，如果一致

则session没有失效，如果不一致则证明session失效了。重定向到登录页面，让用户重新登录。

**注意：JSESSIONID存储在了Cookie的临时存储空间中，浏览器关闭即失效。**

### 创建和获取session对象

- 1.如果请求中拥有session的标识符也就是JSESSIONID，则返回其对应的session对象
- 2.如果请求中没有session的标识符也就是JSESSIONID，则创建新的session对象，并将其JSESSIONID作为从cookie数据存储到浏览器内存中
- 3.如果session对象是失效了，也会重新创建一个session对象，并将其JSESSIONID存储在浏览器内存中。

```java
HttpSession hs = req.getSession();
```

**完整代码**

```java
public class SessionServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //设置请求编码格式
        req.setCharacterEncoding("utf-8");
        //设置响应编码格式
        resp.setContentType("text/html;charset;utf-8");
        //创建session对象
        HttpSession hs = req.getSession();
    }
}
```

![image-20210127170855288](./assets/image-20210127170855288.b2ed0813.png)

```text
浏览器存储JSESSIONID,在访问同项目其他路径就会携带
失效3种情况
1.cookie被清除
2.关掉了浏览器
3.服务端的session超时被销毁
```

### 设置session存储时间

```java
//创建session对象
HttpSession hs = req.getSession();
//设置session存储时间(单位秒)
hs.setMaxInactiveInterval(5);
超时访问生成新的JSESSIONID
在指定的时间内session对象没有被使用则销毁，如果使用了则重新计时。
如果在5秒内又访问则又重新计时5秒，session对象不会销毁
```

### 设置session强制失效

**作用：当用户退出登录时主动销毁session**

```java
//设置强制失效
hs.invalidate();
```

### session存储和获取数据

```java
//存储数据
String name = "张三";
hs.setAttribute("name", name);
//取数据
hs.getAttribute("name")
```

**存储和获取数据**

**存储：**`hs.setAttribute(String name,Object value);`

**获取：**`hs.getAttribute(String name)` 返回的数据类型为**Object**

**注意：存储的动作和取出的动作发生在不同的请求中，但是存储要先于取出执行。**

**使用时机:** 一般用户在登陆web项目时会将用户的个人信息存储到Sesion中，供该用户的其他请求使用。

### 修改session默认失效时间

```xml
<!--D:\tomcat\conf\web.xml-->
<!--注意:
1.全局模式:修改tomcat下的web.xml，tomcat下所有项目有效
2.局部模式:在项目下的web.xml添加如下代码
-->
<session-config>
   <session-timeout>30</session-timeout>
</session-config>
```

## ServletContext对象

**ServletContext对象学习：**

**问题:**  不同的用户使用相同的数据

**解决:**  ServletContext对象

**特点:**  1.服务器创建 2.用户共享

**作用域：** 整个项目内

**生命周期：** 服务器启动到服务器关闭

### 获取ServletContext对象三种方法

```java
//获取servletContext的三种方式:
//第一种方式(常用)
ServletContext sc1 = this.getServletContext();
//第二种方式
ServletContext sc2 = this.getServletConfig().getServletContext();
//第三种方式(常用)
ServletContext sc3 = req.getSession().getServletContext();
```

**完整代码**

```java
public class ServletContextServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //获取servletContext的三种方式:
        //第一种方式
        ServletContext sc1 = this.getServletContext();
        //第二种方式
        ServletContext sc2 = this.getServletConfig().getServletContext();
        //第三种方式
        ServletContext sc3 = req.getSession().getServletContext();
        System.out.println(sc1==sc2);
        System.out.println(sc1==sc3);
    }
}
```

**结果**

```text
浏览器:
http://localhost:8000/ServletContext/context
控制台:
true
true
结论:通过三种方式拿到的是同一个对象
```

### ServletContext对象的存取

**数据存储** `sc.setAttribute(String name, Object value);`

**数据获取**`sc.getAttribute("str") 返回的是Object类型`

**注意：不同的用户可以给ServletContext对象进行数据的存取。获取的数据不存在返回null。**

```java
//数据存储
sc.setAttribute("str", "servletcontext学习");
//获取数据
sc.getAttribute("str");
```

**完整代码**

```java
//数据存储
public class ServletContextServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //获取servletContext的三种方式:
        //第一种方式
        ServletContext sc1 = this.getServletContext();
        //使用ServletContext对象完成数据共享
        //数据存储
        sc1.setAttribute("str", "servletcontext学习");
    }
}
```

### 获取项目中web.xml文件中的全局配置数据

**获取项目中web.xml文件中的全局配置数据**

`sc.getInitParameter(String name);` 根据键的名字返回web.xml中配置的全局数据的值，返回String类型。

如果数据不存在返回null。

`sc.getInitParameterNames();`返回键名的枚举

**配置方式：** 注意 一组标签只能存储一组键值对数据，多组可以声明多个 进行存储。 **作用：** **将静态数据**(不可改变)和代码进行解耦。对于一些重要数据的修改避免改源码。

```xml
<!-- 配置全局数据 -->
<context-param>
  <param-name>name</param-name>
  <param-value>zhangsan</param-value>
</context-param>
```

**配置多个全局参数**

```xml
<!-- 配置多个全局参数 -->
<context-param>
  <param-name>name</param-name>
  <param-value>zhangsan</param-value>
</context-param>
<context-param>
  <param-name>age</param-name>
  <param-value>18</param-value>
</context-param>
```

**获取全局配置数据**

```java
//获取项目web.xml的全局配置数据
String name = sc.getInitParameter("name");
System.out.println(name);
```

**完整代码**

```java
public class ServletContextServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //获取servletContext的三种方式:
        //第一种方式
        ServletContext sc = this.getServletContext();
        //使用ServletContext对象完成数据共享

        //获取项目web.xml的全局配置数据
        String name = sc.getInitParameter("name");
        System.out.println("全局参数:"+name);
    }
}
```

## 获取项目webroot下的资源的绝对路径和流对象

**1.获取项目webroot下的资源的绝对路径，eclipse下为WebContent**

![img](data:image/png;base64,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)

```java
//获取项目根目录下的资源的绝对路径
1.String path = "D:\\\\apache-tomcat-7.0.56\\webapps\\sc\\doc\\1.txt";
System.out.println(path);
//存在问题，当项目部署到远程服务器或没有D盘将出错
```

**项目根目录的绝对路径**

```java
//获取项目根目录下的资源的绝对路径
2.String path = sc.getRealPath("/doc/1.txt");
System.out.println(path);
```

**获取webroot下的资源的流对象**

```java
//获取项目根目录下资源的流对象
InputStream is = sc.getResourceAsStream("/doc/1.txt");
```

**注意:此种方式只能获取项目根目录下的资源流对象，class文件的流对象需要使用类加载器获取。**

## servletConfig对象

- **问题：如何获取在web.xml中给每个servlet单独配置** 的数据呢？
- **解决：** 使用ServletConfig对象
- **使用：** 获取ServletConfig对象获取web.xml中的配置数据

```xml
  <!--web.xml配置
      注意：需要配置到servlet里面
  -->
  <servlet>
    <description></description>
    <display-name>ServletConfigServlet</display-name>
    <servlet-name>ServletConfigServlet</servlet-name>
    <servlet-class>com.zh.servlet.ServletConfigServlet</servlet-class>
    <init-param>
        <param-name>name</param-name>
        <param-value>config</param-value>
    </init-param>
  </servlet>
```

**获取servletConfig对象**

```java
//获取ServletConfig对象
ServletConfig sc = this.getServletConfig();
//获取web.xml中配置的数据
String name = sc.getInitParameter("name");
```

**完整代码**

```java
public class ServletConfigServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //获取ServletConfig对象
        ServletConfig sc = this.getServletConfig();
        //获取web.xml中配置的数据
        String name = sc.getInitParameter("name");
        System.out.println(name);
    }
}
```

结果

```text
浏览器:
http://localhost:8000/ServletConfig/config
控制台:
config
```

## 中文问题

### 单独配置

```text
uname=new String(uname.getBytes("iso8859-1"),"utf-8");
```

### 公共配置

**get方式：**

步骤一：`req.setCharacterEncoding("utf-8");`

步骤二：在tomcat的目录下的conf目录中修改server.xml文件：在Connector标签中增加属性 `useBodyEncodingForURI="true"`

**post方式：**

```
req.setCharacterEncoding("utf-8");
```

## 文件上传

### 上传页面

```html
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<form action="uploadPhoto" method="post" enctype="multipart/form-data">
  英雄名称:<input type="text" name="heroName" /> <br>
  上传头像 : <input type="file" name="filepath" /> <br>
  <input type="submit" value="上传">
</form>
```

### servlet

需要用到两个第三方的jar包，**commons-io-1.4.jar**和**commons-fileupload-1.2.2.jar**。

```java
public class UploadPhotoServlet extends HttpServlet {
  
    public void doPost(HttpServletRequest request, HttpServletResponse response) {
  
        String filename = null;
        try {
            DiskFileItemFactory factory = new DiskFileItemFactory();
            ServletFileUpload upload = new ServletFileUpload(factory);
            // 设置上传文件的大小限制为1M
            factory.setSizeThreshold(1024 * 1024);
             
            List items = null;
            try {
                items = upload.parseRequest(request);
            } catch (FileUploadException e) {
                e.printStackTrace();
            }
  
            Iterator iter = items.iterator();
            while (iter.hasNext()) {
                FileItem item = (FileItem) iter.next();
                if (!item.isFormField()) {
  
                    // 根据时间戳创建头像文件
                    filename = System.currentTimeMillis() + ".jpg";
                     
                    //通过getRealPath获取上传文件夹，如果项目在e:/project/j2ee/web,那么就会自动获取到 e:/project/j2ee/web/uploaded
                    String photoFolder =request.getServletContext().getRealPath("uploaded");
                     
                    File f = new File(photoFolder, filename);
                    f.getParentFile().mkdirs();
  
                    // 通过item.getInputStream()获取浏览器上传的文件的输入流
                    InputStream is = item.getInputStream();
  
                    // 复制文件
                    FileOutputStream fos = new FileOutputStream(f);
                    byte b[] = new byte[1024 * 1024];
                    int length = 0;
                    while (-1 != (length = is.read(b))) {
                        fos.write(b, 0, length);
                    }
                    fos.close();
  
                } else {
                    System.out.println(item.getFieldName());
                    String value = item.getString();
                    value = new String(value.getBytes("ISO-8859-1"), "UTF-8");
                    System.out.println(value);
                }
            }
             
            String html = "<img width='200' height='150' src='uploaded/%s' />";
            response.setContentType("text/html");
            PrintWriter pw= response.getWriter();
             
            pw.format(html, filename);
             
        } catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
}
```